sample je popsan v 
https://blogs.msdn.microsoft.com/odatateam/2018/07/03/asp-net-core-odata-now-available/

další příklad:
https://www.mithunvp.com/write-custom-asp-net-core-middleware-web-api/